<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Inference | BIOL 480/580Q: Ecological Modeling (Fall 2024)</title>
  <meta name="description" content="4 Inference | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Inference | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Inference | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
  
  
  

<meta name="author" content="Eliza Grames" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="null-hypothesis-significance-testing.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>1.1</b> About this ‘book’</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-this-course"><i class="fa fa-check"></i><b>1.2</b> Why this course?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#getting-comfortable-with-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Getting comfortable with R and RStudio</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#some-terms-and-definitions"><i class="fa fa-check"></i><b>1.3.1</b> Some terms and definitions</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.3.2</b> Customizing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-to-approach-this-course"><i class="fa fa-check"></i><b>1.4</b> How to approach this course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2</b> Probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability.html"><a href="probability.html#bernoulli-distribution"><i class="fa fa-check"></i><b>2.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html#binomial-distribution"><i class="fa fa-check"></i><b>2.2</b> Binomial distribution</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability.html"><a href="probability.html#guillemot-example"><i class="fa fa-check"></i><b>2.2.1</b> Guillemot example</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability.html"><a href="probability.html#coral-example"><i class="fa fa-check"></i><b>2.2.2</b> Coral example</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="probability.html"><a href="probability.html#probability-mass"><i class="fa fa-check"></i><b>2.3</b> Probability mass</a></li>
<li class="chapter" data-level="2.4" data-path="probability.html"><a href="probability.html#the-normal-gaussian-distribution"><i class="fa fa-check"></i><b>2.4</b> The Normal (Gaussian) distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="probability.html"><a href="probability.html#guillemot-weight"><i class="fa fa-check"></i><b>2.4.1</b> Guillemot weight</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="probability.html"><a href="probability.html#probability-density"><i class="fa fa-check"></i><b>2.5</b> Probability density</a></li>
<li class="chapter" data-level="2.6" data-path="probability.html"><a href="probability.html#the-standard-normal-distribution"><i class="fa fa-check"></i><b>2.6</b> The Standard Normal Distribution</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="probability.html"><a href="probability.html#functions-1"><i class="fa fa-check"></i><b>2.6.1</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>3</b> Null hypothesis significance testing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#a-brief-history-of-statistics-and-eugenics"><i class="fa fa-check"></i><b>3.1</b> A brief history of statistics and eugenics</a></li>
<li class="chapter" data-level="3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#t-distribution-and-t-tests"><i class="fa fa-check"></i><b>3.2</b> T-distribution and t-tests</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#butterfly-wing-size"><i class="fa fa-check"></i><b>3.2.1</b> Butterfly wing size</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#anova"><i class="fa fa-check"></i><b>3.3</b> ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4</b> Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference.html"><a href="inference.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="4.2" data-path="inference.html"><a href="inference.html#credible-intervals"><i class="fa fa-check"></i><b>4.2</b> Credible intervals</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL 480/580Q: Ecological Modeling (Fall 2024)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inference" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Inference<a href="inference.html#inference" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One of the goals of statistics is to make inference about the natural world. We make <em>inference</em> based on <em>observations</em> taken on our <em>sample</em>. In the Arctic butterfly example, the sample was the 2501 individual butterflies that Daly et al. measured. The observations are not just the length of each individual, but also their species identity (and lots of other data we did not dig into yet). In statistics, we assume that our sample is representative of the <em>population</em>. This does not mean a population in the ecological or evolutionary sense, but rather the universe that we are trying to make inference about. The way we defined the population for the t-tests was at the level of the species, i.e. we assumed the 968 <em>Boloria chariclea</em> individuals represented that species for the purposes of inference. The properties we measure on our sample are the variables at our disposal, i.e. species, length, growing degree days, region, etc. each matched to a single observation.</p>
<p>When making inference, we can assume that the sample mean is an unbiased estimator of the population mean if:
1. Individuals are randomly selected from the population. i.e. we did not just choose the closest butterflies, or the prettiest butterflies, or the slowest butterflies, etc.
2. Observations are independent of each other. i.e. not all the butterflies came from the same site, or the same person measured one species and a different person measured the other species, etc. This assumption is rarely met in ecology (…including in our t-tests that we did above).
3. The population parameter we are interested in can be described as a <em>random variable</em>, meaning that it comes from a probability distribution.</p>
<p>In calculating the sample mean <span class="math inline">\(\bar{x}\)</span> and sample variance <span class="math inline">\(s^2\)</span>, we are trying to make inference about the population mean <span class="math inline">\(mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. The latter are our population <em>parameters</em>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="inference.html#cb82-1" tabindex="-1"></a><span class="co"># define our population parameters</span></span>
<span id="cb82-2"><a href="inference.html#cb82-2" tabindex="-1"></a>true_mean <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb82-3"><a href="inference.html#cb82-3" tabindex="-1"></a>true_variance <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb82-4"><a href="inference.html#cb82-4" tabindex="-1"></a>std.dev <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(true_variance)</span>
<span id="cb82-5"><a href="inference.html#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="inference.html#cb82-6" tabindex="-1"></a><span class="co"># Sample some individuals from the population</span></span>
<span id="cb82-7"><a href="inference.html#cb82-7" tabindex="-1"></a><span class="co"># let&#39;s say we are still looking at butterfly sizes</span></span>
<span id="cb82-8"><a href="inference.html#cb82-8" tabindex="-1"></a><span class="co"># but we only have 32 individuals in our sample this time</span></span>
<span id="cb82-9"><a href="inference.html#cb82-9" tabindex="-1"></a>n.obs <span class="ot">&lt;-</span> <span class="dv">32</span></span>
<span id="cb82-10"><a href="inference.html#cb82-10" tabindex="-1"></a>wing_length <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.obs, true_mean, <span class="at">sd =</span> std.dev)</span>
<span id="cb82-11"><a href="inference.html#cb82-11" tabindex="-1"></a></span>
<span id="cb82-12"><a href="inference.html#cb82-12" tabindex="-1"></a><span class="co"># What is the mean estimated from this sample?</span></span>
<span id="cb82-13"><a href="inference.html#cb82-13" tabindex="-1"></a><span class="fu">mean</span>(wing_length)</span></code></pre></div>
<pre><code>## [1] 16.69938</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="inference.html#cb84-1" tabindex="-1"></a><span class="co"># How close it is to the true population mean?</span></span>
<span id="cb84-2"><a href="inference.html#cb84-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.1</span>), </span>
<span id="cb84-3"><a href="inference.html#cb84-3" tabindex="-1"></a>     <span class="at">y=</span><span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.1</span>), <span class="at">mean =</span> true_mean, <span class="at">sd =</span> std.dev), </span>
<span id="cb84-4"><a href="inference.html#cb84-4" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, </span>
<span id="cb84-5"><a href="inference.html#cb84-5" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, </span>
<span id="cb84-6"><a href="inference.html#cb84-6" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Value&quot;</span>,</span>
<span id="cb84-7"><a href="inference.html#cb84-7" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb84-8"><a href="inference.html#cb84-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(wing_length), <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># sample mean</span></span>
<span id="cb84-9"><a href="inference.html#cb84-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">17</span>, <span class="at">lty=</span><span class="dv">1</span>) <span class="co"># true mean</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="inference.html#cb85-1" tabindex="-1"></a><span class="co"># What if we repeated this sample? </span></span>
<span id="cb85-2"><a href="inference.html#cb85-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.1</span>), </span>
<span id="cb85-3"><a href="inference.html#cb85-3" tabindex="-1"></a>     <span class="at">y=</span><span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.1</span>), <span class="at">mean =</span> true_mean, <span class="at">sd =</span> std.dev), </span>
<span id="cb85-4"><a href="inference.html#cb85-4" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, </span>
<span id="cb85-5"><a href="inference.html#cb85-5" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, </span>
<span id="cb85-6"><a href="inference.html#cb85-6" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Value&quot;</span>,</span>
<span id="cb85-7"><a href="inference.html#cb85-7" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb85-8"><a href="inference.html#cb85-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(wing_length), <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># sample mean</span></span>
<span id="cb85-9"><a href="inference.html#cb85-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">17</span>, <span class="at">lty=</span><span class="dv">1</span>) <span class="co"># true mean</span></span>
<span id="cb85-10"><a href="inference.html#cb85-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(<span class="fu">rnorm</span>(n.obs, true_mean, std.dev)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;tomato2&quot;</span>) <span class="co"># a new sample</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<p>Frequentist statistics assumes that population parameters are fixed, and the data are random. Bayesians, on the other hand, assume that the data are fixed and the parameters are random. In other words, frequentists assume that the world works in a certain way and we observe it imperfectly each time we collect a sample, while Bayesians tend to think more in terms of probability distributions that could have generated the data that we observed.
# Central limit theorem</p>
<p>As our sample size increases, the sample mean <span class="math inline">\(\bar{x}\)</span> will more closely approximate the population mean <span class="math inline">\(\mu\)</span>. To demonstrate this, we are going to use something called a <code>for</code> loop. A <code>for</code> loop allows us to iterate a process.</p>
<p>One way to think about a <code>for</code> loop is as a set of instructions for an extremely literal toddler. Pretend you have this bowl of fruit, and you need the toddler to pick up a piece of fruit, bring it to the kitchen, wash it, put it into a new bowl, and then repeat this for the next fruit. They can only carry one fruit at a time. How we would write this as a for loop is to first specify what they will be working with, i.e. “for each fruit in the fruit bowl” is written as <code>for(fruit in fruit_bowl)</code>. Then, the next step would be “take fruit to kitchen” which might be <code>to_kitchen(fruit)</code>, and so on. In the code below, we will use the <code>print()</code> function instead because there is no such thing as a <code>to_kitchen</code> function (unless you write it yourself).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="inference.html#cb86-1" tabindex="-1"></a>fruit_bowl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;kiwi&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;pomegranate&quot;</span>, <span class="st">&quot;pear&quot;</span>)</span>
<span id="cb86-2"><a href="inference.html#cb86-2" tabindex="-1"></a></span>
<span id="cb86-3"><a href="inference.html#cb86-3" tabindex="-1"></a><span class="cf">for</span>(fruit <span class="cf">in</span> fruit_bowl){</span>
<span id="cb86-4"><a href="inference.html#cb86-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;pick up&quot;</span>, fruit)) <span class="co"># paste is a function that concatenates strings</span></span>
<span id="cb86-5"><a href="inference.html#cb86-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;take&quot;</span>, fruit, <span class="st">&quot;to kitchen&quot;</span>))</span>
<span id="cb86-6"><a href="inference.html#cb86-6" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;wash&quot;</span>, fruit))</span>
<span id="cb86-7"><a href="inference.html#cb86-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;set&quot;</span>, fruit, <span class="st">&quot;in new bowl&quot;</span>))</span>
<span id="cb86-8"><a href="inference.html#cb86-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;pick up kiwi&quot;
## [1] &quot;take kiwi to kitchen&quot;
## [1] &quot;wash kiwi&quot;
## [1] &quot;set kiwi in new bowl&quot;
## [1] &quot;pick up banana&quot;
## [1] &quot;take banana to kitchen&quot;
## [1] &quot;wash banana&quot;
## [1] &quot;set banana in new bowl&quot;
## [1] &quot;pick up apple&quot;
## [1] &quot;take apple to kitchen&quot;
## [1] &quot;wash apple&quot;
## [1] &quot;set apple in new bowl&quot;
## [1] &quot;pick up pomegranate&quot;
## [1] &quot;take pomegranate to kitchen&quot;
## [1] &quot;wash pomegranate&quot;
## [1] &quot;set pomegranate in new bowl&quot;
## [1] &quot;pick up pear&quot;
## [1] &quot;take pear to kitchen&quot;
## [1] &quot;wash pear&quot;
## [1] &quot;set pear in new bowl&quot;</code></pre>
<p>A more common way to use <code>for</code> loops is with an index. Rather than setting up our fruit bowl in advance, we instead have a list of fruits and we can subset each one based on numbers. i.e. <code>fruit_bowl[1]</code> is <code>"kiwi"</code>. What is nice about this is you can combine different vectors and subset them by the same index.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="inference.html#cb88-1" tabindex="-1"></a>fruits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apples&quot;</span>, <span class="st">&quot;bananas&quot;</span>, <span class="st">&quot;grapes&quot;</span>)</span>
<span id="cb88-2"><a href="inference.html#cb88-2" tabindex="-1"></a><span class="co"># here we use i as a placeholder to stand for index</span></span>
<span id="cb88-3"><a href="inference.html#cb88-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb88-4"><a href="inference.html#cb88-4" tabindex="-1"></a>  <span class="fu">print</span>(fruits[i])</span>
<span id="cb88-5"><a href="inference.html#cb88-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;apples&quot;
## [1] &quot;bananas&quot;
## [1] &quot;grapes&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="inference.html#cb90-1" tabindex="-1"></a><span class="co"># add in a second vector of adjectives</span></span>
<span id="cb90-2"><a href="inference.html#cb90-2" tabindex="-1"></a>adjectives <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;decent&quot;</span>, <span class="st">&quot;disgusting&quot;</span>, <span class="st">&quot;just okay&quot;</span>)</span>
<span id="cb90-3"><a href="inference.html#cb90-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb90-4"><a href="inference.html#cb90-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(fruits[i], <span class="st">&quot;are&quot;</span>, adjectives[i]))</span>
<span id="cb90-5"><a href="inference.html#cb90-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;apples are decent&quot;
## [1] &quot;bananas are disgusting&quot;
## [1] &quot;grapes are just okay&quot;</code></pre>
<p>You can also nest <code>for</code> loops within each other, but that is for a different day. What we want to use <code>for</code> loops for right now is to combine them with a probability density function (<code>rnorm</code>) to visualize the central limit theorem.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="inference.html#cb92-1" tabindex="-1"></a><span class="co"># Using the same population parameters as above, if we were to sample more </span></span>
<span id="cb92-2"><a href="inference.html#cb92-2" tabindex="-1"></a><span class="co"># individuals, would we converge towards the true mean?</span></span>
<span id="cb92-3"><a href="inference.html#cb92-3" tabindex="-1"></a>n.samples <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb92-4"><a href="inference.html#cb92-4" tabindex="-1"></a></span>
<span id="cb92-5"><a href="inference.html#cb92-5" tabindex="-1"></a>more_samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.samples, true_mean, <span class="at">sd =</span> std.dev)</span>
<span id="cb92-6"><a href="inference.html#cb92-6" tabindex="-1"></a></span>
<span id="cb92-7"><a href="inference.html#cb92-7" tabindex="-1"></a>running_avg <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb92-8"><a href="inference.html#cb92-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.samples){</span>
<span id="cb92-9"><a href="inference.html#cb92-9" tabindex="-1"></a>  running_avg[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(more_samples[<span class="dv">1</span><span class="sc">:</span>i])</span>
<span id="cb92-10"><a href="inference.html#cb92-10" tabindex="-1"></a>}</span>
<span id="cb92-11"><a href="inference.html#cb92-11" tabindex="-1"></a></span>
<span id="cb92-12"><a href="inference.html#cb92-12" tabindex="-1"></a><span class="fu">plot</span>(running_avg, </span>
<span id="cb92-13"><a href="inference.html#cb92-13" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, </span>
<span id="cb92-14"><a href="inference.html#cb92-14" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>, </span>
<span id="cb92-15"><a href="inference.html#cb92-15" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">18</span>),</span>
<span id="cb92-16"><a href="inference.html#cb92-16" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Mean wing size&quot;</span>, </span>
<span id="cb92-17"><a href="inference.html#cb92-17" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Number of samples&quot;</span>,</span>
<span id="cb92-18"><a href="inference.html#cb92-18" tabindex="-1"></a>     <span class="at">axes=</span>F, </span>
<span id="cb92-19"><a href="inference.html#cb92-19" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb92-20"><a href="inference.html#cb92-20" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>); <span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb92-21"><a href="inference.html#cb92-21" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>true_mean, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div id="confidence-intervals" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Confidence intervals<a href="inference.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Remember that in a frequentist approach to inference, the population parameters are fixed and the data are random. This means that sometimes our sample will not contain the true population mean. Using the standard deviation of our data and our significance threshold, we can generate a confidence interval to describe this process. Often, people will use a 95% confidence interval because it matches the convention of <span class="math inline">\(\alpha = 0.05\)</span>. What a 95% confidence interval tells us is that 95% of the time, if you go out and calculate an interval in this way, it will contain the true population mean.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="inference.html#cb93-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.1</span>), </span>
<span id="cb93-2"><a href="inference.html#cb93-2" tabindex="-1"></a>     <span class="at">y=</span><span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="fl">0.1</span>), <span class="at">mean =</span> true_mean, <span class="at">sd =</span> std.dev), </span>
<span id="cb93-3"><a href="inference.html#cb93-3" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;l&quot;</span>, </span>
<span id="cb93-4"><a href="inference.html#cb93-4" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Value&quot;</span>,</span>
<span id="cb93-5"><a href="inference.html#cb93-5" tabindex="-1"></a>     <span class="at">axes=</span>F)</span>
<span id="cb93-6"><a href="inference.html#cb93-6" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>); <span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb93-7"><a href="inference.html#cb93-7" tabindex="-1"></a></span>
<span id="cb93-8"><a href="inference.html#cb93-8" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(true_mean<span class="fl">-1.96</span><span class="sc">*</span>std.dev, true_mean<span class="fl">+1.96</span><span class="sc">*</span>std.dev)</span>
<span id="cb93-9"><a href="inference.html#cb93-9" tabindex="-1"></a></span>
<span id="cb93-10"><a href="inference.html#cb93-10" tabindex="-1"></a>xvals <span class="ot">&lt;-</span> <span class="fu">seq</span>(ci[<span class="dv">1</span>], ci[<span class="dv">2</span>], <span class="fl">0.1</span>)</span>
<span id="cb93-11"><a href="inference.html#cb93-11" tabindex="-1"></a></span>
<span id="cb93-12"><a href="inference.html#cb93-12" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(xvals, <span class="fu">rev</span>(xvals)), </span>
<span id="cb93-13"><a href="inference.html#cb93-13" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">dnorm</span>(xvals, true_mean, std.dev), </span>
<span id="cb93-14"><a href="inference.html#cb93-14" tabindex="-1"></a>              <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(xvals))),</span>
<span id="cb93-15"><a href="inference.html#cb93-15" tabindex="-1"></a>        <span class="at">col=</span><span class="st">&quot;#bb5406bb&quot;</span>, <span class="at">border=</span>F)</span>
<span id="cb93-16"><a href="inference.html#cb93-16" tabindex="-1"></a><span class="fu">text</span>(ci[<span class="dv">1</span>], <span class="dv">0</span>, <span class="st">&quot;μ - 1.96*σ&quot;</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb93-17"><a href="inference.html#cb93-17" tabindex="-1"></a><span class="fu">text</span>(ci[<span class="dv">2</span>], <span class="dv">0</span>, <span class="st">&quot;μ + 1.96*σ&quot;</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" />
That means if you went out and collected observations on a sample (e.g. 32 butterflies) and then repeated that 100 times (i.e. 100 replicates of each sample, so 320 total individual butterflies, but observed independently in 100 different replicates, each with a sample size of 32), you would expect that 95 out of those 100 confidence intervals would include the true population mean.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="inference.html#cb94-1" tabindex="-1"></a>n.sp1 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb94-2"><a href="inference.html#cb94-2" tabindex="-1"></a>n.sp2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb94-3"><a href="inference.html#cb94-3" tabindex="-1"></a></span>
<span id="cb94-4"><a href="inference.html#cb94-4" tabindex="-1"></a>mu.sp1 <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb94-5"><a href="inference.html#cb94-5" tabindex="-1"></a>mu.sp2 <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb94-6"><a href="inference.html#cb94-6" tabindex="-1"></a></span>
<span id="cb94-7"><a href="inference.html#cb94-7" tabindex="-1"></a>true_diff <span class="ot">&lt;-</span> mu.sp1 <span class="sc">-</span> mu.sp2</span>
<span id="cb94-8"><a href="inference.html#cb94-8" tabindex="-1"></a></span>
<span id="cb94-9"><a href="inference.html#cb94-9" tabindex="-1"></a>n.reps <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb94-10"><a href="inference.html#cb94-10" tabindex="-1"></a></span>
<span id="cb94-11"><a href="inference.html#cb94-11" tabindex="-1"></a><span class="co"># set up placeholder objects</span></span>
<span id="cb94-12"><a href="inference.html#cb94-12" tabindex="-1"></a>rep_diff <span class="ot">&lt;-</span> rep_low <span class="ot">&lt;-</span> rep_up <span class="ot">&lt;-</span> contains_true <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb94-13"><a href="inference.html#cb94-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.reps){</span>
<span id="cb94-14"><a href="inference.html#cb94-14" tabindex="-1"></a>sample.sp1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.sp1, mu.sp1, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb94-15"><a href="inference.html#cb94-15" tabindex="-1"></a>sample.sp2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.sp2, mu.sp2, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb94-16"><a href="inference.html#cb94-16" tabindex="-1"></a></span>
<span id="cb94-17"><a href="inference.html#cb94-17" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample.sp1, sample.sp2)</span>
<span id="cb94-18"><a href="inference.html#cb94-18" tabindex="-1"></a></span>
<span id="cb94-19"><a href="inference.html#cb94-19" tabindex="-1"></a>rep_diff[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample.sp1) <span class="sc">-</span> <span class="fu">mean</span>(sample.sp2)</span>
<span id="cb94-20"><a href="inference.html#cb94-20" tabindex="-1"></a>rep_low[i] <span class="ot">&lt;-</span> mod1<span class="sc">$</span>conf.int[<span class="dv">1</span>]</span>
<span id="cb94-21"><a href="inference.html#cb94-21" tabindex="-1"></a>rep_up[i] <span class="ot">&lt;-</span> mod1<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb94-22"><a href="inference.html#cb94-22" tabindex="-1"></a></span>
<span id="cb94-23"><a href="inference.html#cb94-23" tabindex="-1"></a>contains_true[i] <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(rep_low[i]<span class="sc">&lt;</span>true_diff <span class="sc">&amp;</span> rep_up[i]<span class="sc">&gt;</span>true_diff)</span>
<span id="cb94-24"><a href="inference.html#cb94-24" tabindex="-1"></a>  </span>
<span id="cb94-25"><a href="inference.html#cb94-25" tabindex="-1"></a>}</span>
<span id="cb94-26"><a href="inference.html#cb94-26" tabindex="-1"></a></span>
<span id="cb94-27"><a href="inference.html#cb94-27" tabindex="-1"></a><span class="fu">plot</span>(rep_diff <span class="sc">~</span> <span class="fu">seq</span>(<span class="dv">1</span>, n.reps, <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="sc">-</span><span class="dv">3</span>))</span>
<span id="cb94-28"><a href="inference.html#cb94-28" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0=</span><span class="fu">seq</span>(<span class="dv">1</span>, n.reps, <span class="dv">1</span>), <span class="at">y0=</span>rep_low, <span class="at">y1=</span>rep_up, <span class="at">code=</span><span class="dv">3</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">length=</span><span class="fl">0.05</span>)</span>
<span id="cb94-29"><a href="inference.html#cb94-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>true_diff)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="inference.html#cb95-1" tabindex="-1"></a><span class="fu">table</span>(contains_true)</span></code></pre></div>
<pre><code>## contains_true
## FALSE  TRUE 
##     3    97</code></pre>
<div class="float">
<img src="https://m.media-amazon.com/images/I/71V226GLi3S._AC_UF894,1000_QL80_.jpg" alt="Frequentists." />
<div class="figcaption">Frequentists.</div>
</div>
</div>
<div id="credible-intervals" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Credible intervals<a href="inference.html#credible-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will get to Bayesian statistics later in the semester, but for now, know that the Bayesian equivalent of a confidence interval is called a credible interval. The interpretation of a 95% Bayesian credible interval is that there is a 95% probability that the true population mean lies within that interval. This is frequently mixed up in the literature and frequentists often describe confidence intervals as if they are credible intervals but this is 100% not true.</p>
<div class="float">
<img src="https://media.licdn.com/dms/image/C5612AQFKQCinuG7TEw/article-cover_image-shrink_600_2000/0/1620234277641?e=2147483647&amp;v=beta&amp;t=p7TAlJk4WaGZoKCuZAmqaWbmkyhIL7bMBda9jXpH3PU" alt="Bayesians." />
<div class="figcaption">Bayesians.</div>
</div>
<p><img src="https://miro.medium.com/v2/resize:fit:1146/1*Z7IKnMjZSMoocuQEBg7kow.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="null-hypothesis-significance-testing.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
