<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Null hypothesis significance testing | BIOL 480/580Q: Ecological Modeling (Fall 2024)</title>
  <meta name="description" content="3 Null hypothesis significance testing | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Null hypothesis significance testing | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Null hypothesis significance testing | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
  
  
  

<meta name="author" content="Eliza Grames" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probability.html"/>
<link rel="next" href="inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>1.1</b> About this ‘book’</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-this-course"><i class="fa fa-check"></i><b>1.2</b> Why this course?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#getting-comfortable-with-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Getting comfortable with R and RStudio</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#some-terms-and-definitions"><i class="fa fa-check"></i><b>1.3.1</b> Some terms and definitions</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#customizing-rstudio"><i class="fa fa-check"></i><b>1.3.2</b> Customizing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-to-approach-this-course"><i class="fa fa-check"></i><b>1.4</b> How to approach this course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2</b> Probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability.html"><a href="probability.html#bernoulli-distribution"><i class="fa fa-check"></i><b>2.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html#binomial-distribution"><i class="fa fa-check"></i><b>2.2</b> Binomial distribution</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability.html"><a href="probability.html#guillemot-example"><i class="fa fa-check"></i><b>2.2.1</b> Guillemot example</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability.html"><a href="probability.html#coral-example"><i class="fa fa-check"></i><b>2.2.2</b> Coral example</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="probability.html"><a href="probability.html#probability-mass"><i class="fa fa-check"></i><b>2.3</b> Probability mass</a></li>
<li class="chapter" data-level="2.4" data-path="probability.html"><a href="probability.html#the-normal-gaussian-distribution"><i class="fa fa-check"></i><b>2.4</b> The Normal (Gaussian) distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="probability.html"><a href="probability.html#guillemot-weight"><i class="fa fa-check"></i><b>2.4.1</b> Guillemot weight</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="probability.html"><a href="probability.html#probability-density"><i class="fa fa-check"></i><b>2.5</b> Probability density</a></li>
<li class="chapter" data-level="2.6" data-path="probability.html"><a href="probability.html#the-standard-normal-distribution"><i class="fa fa-check"></i><b>2.6</b> The Standard Normal Distribution</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="probability.html"><a href="probability.html#functions-1"><i class="fa fa-check"></i><b>2.6.1</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>3</b> Null hypothesis significance testing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#a-brief-history-of-statistics-and-eugenics"><i class="fa fa-check"></i><b>3.1</b> A brief history of statistics and eugenics</a></li>
<li class="chapter" data-level="3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#t-distribution-and-t-tests"><i class="fa fa-check"></i><b>3.2</b> T-distribution and t-tests</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#butterfly-wing-size"><i class="fa fa-check"></i><b>3.2.1</b> Butterfly wing size</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#anova"><i class="fa fa-check"></i><b>3.3</b> ANOVA</a></li>
<li class="chapter" data-level="3.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#type-i-and-type-ii-error"><i class="fa fa-check"></i><b>3.4</b> Type I and Type II error</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4</b> Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference.html"><a href="inference.html#lyrebird-song-repertoire"><i class="fa fa-check"></i><b>4.1</b> Lyrebird song repertoire</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-law-of-large-numbers.html"><a href="the-law-of-large-numbers.html"><i class="fa fa-check"></i><b>5</b> The law of large numbers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-law-of-large-numbers.html"><a href="the-law-of-large-numbers.html#confidence-intervals"><i class="fa fa-check"></i><b>5.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="5.2" data-path="the-law-of-large-numbers.html"><a href="the-law-of-large-numbers.html#lyrebird-population-differences"><i class="fa fa-check"></i><b>5.2</b> Lyrebird population differences</a></li>
<li class="chapter" data-level="5.3" data-path="the-law-of-large-numbers.html"><a href="the-law-of-large-numbers.html#lyrebird-mating-success-and-the-sampling-distribution"><i class="fa fa-check"></i><b>5.3</b> Lyrebird mating success and the sampling distribution</a></li>
<li class="chapter" data-level="5.4" data-path="the-law-of-large-numbers.html"><a href="the-law-of-large-numbers.html#credible-intervals"><i class="fa fa-check"></i><b>5.4</b> Credible intervals</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualizing-group-differences.html"><a href="visualizing-group-differences.html"><i class="fa fa-check"></i><b>6</b> Visualizing group differences</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualizing-group-differences.html"><a href="visualizing-group-differences.html#boxplots"><i class="fa fa-check"></i><b>6.1</b> Boxplots</a></li>
<li class="chapter" data-level="6.2" data-path="visualizing-group-differences.html"><a href="visualizing-group-differences.html#beehive-plots"><i class="fa fa-check"></i><b>6.2</b> Beehive plots</a></li>
<li class="chapter" data-level="6.3" data-path="visualizing-group-differences.html"><a href="visualizing-group-differences.html#density-plots"><i class="fa fa-check"></i><b>6.3</b> Density plots</a></li>
<li class="chapter" data-level="6.4" data-path="visualizing-group-differences.html"><a href="visualizing-group-differences.html#raincloud-plots"><i class="fa fa-check"></i><b>6.4</b> Raincloud plots</a></li>
<li class="chapter" data-level="6.5" data-path="visualizing-group-differences.html"><a href="visualizing-group-differences.html#paired-slopes"><i class="fa fa-check"></i><b>6.5</b> Paired slopes</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL 480/580Q: Ecological Modeling (Fall 2024)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="null-hypothesis-significance-testing" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Null hypothesis significance testing<a href="null-hypothesis-significance-testing.html#null-hypothesis-significance-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Conventionally in statistics, people use a threshold (<span class="math inline">\(\alpha\)</span>) of 0.05 to denote statistical significance. If the probability of observing your data, <em>or data more extreme</em>, is less than the threshold you set, you reject the null hypothesis. This is why you so often see things like <span class="math inline">\(p &lt; 0.05\)</span> in the results section of papers (particularly in older papers, i.e. when you needed a lookup table). Conversely, if your p-value is greater than <span class="math inline">\(\alpha\)</span>, you fail to reject the null hypothesis. You never accept your hypothesis, and you never accept the null hypothesis. You just fail, or do not fail, to reject the null.</p>
<p><img src="https://i.pinimg.com/1200x/dd/ac/14/ddac14c15096e7961a5d5ac9d73e0329.jpg" /></p>
<p>Why do we conventionally use <span class="math inline">\(\alpha = 0.05\)</span> as a threshold?</p>
<blockquote>
<p>“The value for which P=.05, or 1 in 20, is 1.96 or nearly 2; it is convenient to take this point as a limit in judging whether a deviation is to be considered significant or not. Deviations exceeding twice the standard deviation are thus formally regarded as significant.” - Fisher (1925)</p>
</blockquote>
<div id="a-brief-history-of-statistics-and-eugenics" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> A brief history of statistics and eugenics<a href="null-hypothesis-significance-testing.html#a-brief-history-of-statistics-and-eugenics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many figures in ecology and evolutionary biology that were giants in their field and helped shape modern science, and who were also extremely problematic individuals (and not just because ‘it was a different time’). Often, the way we learn about these individuals is first through their contributions to the field, and secondarily that they were a ‘bad person’ but that we should still value their intellectual contributions and somehow consider those to be separate from the person. For example, John James Audubon made numerous contributions to ornithology, and also bought and sold enslaved people. You could argue that those are separate aspects of the same person (…you could also argue that he greatly benefited from his status in society as a result of oppressing and enslaving other people and that enabled him to contribute to ornithology, but that is a conversation for a different course…). This is not the case with statistics. Most of modern statistics is built on work done by Sir Francis Galton, Karl Pearson, and Ronald Fisher, all of whom were staunch advocates of eugenics. They also collectively developed the ideas of standard deviation, correlation, regression to the mean, the correlation coefficient, method of moments, <span class="math inline">\(\chi^2\)</span> test, p-values, principle components analysis, and many other fundamental ideas in statistics. The point is not that these men made exceptional contributions to statistics and also happened to be eugenicists, but rather that they <em>developed statistics to support their eugenicist viewpoints.</em> After all, who could argue with the <a href="https://nautil.us/how-eugenics-shaped-statistics-238014/">data they showed to support their view that other races were inferior to white Europeans</a>?</p>
<div class="float">
<img src="https://collectionimages.npg.org.uk/large/mw166224/Karl-Pearson-Sir-Francis-Galton.jpg" alt="Karl Pearson (left) and Sir Francis Galton (right), circa 1910" />
<div class="figcaption">Karl Pearson (left) and Sir Francis Galton (right), circa 1910</div>
</div>
<p>Many of the concepts we still use to this day in statistics come out of this tradition. For example, even the idea that a population (in the statistical sense) can be described from a single distribution is rooted in eugenics. At the same time Pearson was writing about mixtures of ‘homogeneous groups’ from a mathematical perspective, he was also advocating for colonialism and destruction of what he considered to be ‘inferior races’ because a more ‘homogeneous’ society was better.</p>
<div class="float">
<img src="img/pearson_eug.png" alt="Pearson in Contributions to the Mathematical Theory of Evolution in 1894" />
<div class="figcaption">Pearson in <em>Contributions to the Mathematical Theory of Evolution</em> in 1894</div>
</div>
<div class="float">
<img src="img/pearson_eug2.png" alt="Pearson in National Life from the Standpoint of Science" />
<div class="figcaption">Pearson in <em>National Life from the Standpoint of Science</em></div>
</div>
<p>The specific values, thresholds, cutoffs, and conventions that underlie most of null hypothesis significance testing were developed to support a eugenicist agenda. Always remember that they are not mathematically justified or ordained by some law of nature, but rather prescribed by a handful of like-minded eugenicists over a century ago. You should not feel bad about “breaking” their rules from time to time. Also, statistics is constantly evolving, so there are no hard and fast rules to follow.</p>
</div>
<div id="t-distribution-and-t-tests" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> T-distribution and t-tests<a href="null-hypothesis-significance-testing.html#t-distribution-and-t-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With Z-scores, we are assuming an infinite sample size when we use the standard deviation in the denominator. This is never the case with real data, though as our sample size increases, it becomes less and less important. To account for the reality of small sample sizes, often researchers will use the t distribution instead. The t distribution was developed by William Sealy Gosset, a brewer at Guinness, who essentially wanted to quality check different batches of beer with statistics, but could not use the normal distribution because of the small sample sizes. He published it under the pseudonym Student, which is why it is now called Student’s t-test.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="null-hypothesis-significance-testing.html#cb62-1" tabindex="-1"></a><span class="co"># create an object of xvalues over a reasonable range to plot</span></span>
<span id="cb62-2"><a href="null-hypothesis-significance-testing.html#cb62-2" tabindex="-1"></a>xvals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="dv">4</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb62-3"><a href="null-hypothesis-significance-testing.html#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="null-hypothesis-significance-testing.html#cb62-4" tabindex="-1"></a><span class="co"># plot the standardized normal (z) distribution over this range</span></span>
<span id="cb62-5"><a href="null-hypothesis-significance-testing.html#cb62-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dnorm</span>(xvals, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb62-6"><a href="null-hypothesis-significance-testing.html#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="null-hypothesis-significance-testing.html#cb62-7" tabindex="-1"></a><span class="co"># use the lines() function to add a line with the t distribution over the same range</span></span>
<span id="cb62-8"><a href="null-hypothesis-significance-testing.html#cb62-8" tabindex="-1"></a><span class="co"># and assume we have 1 degree of freedom (i.e. a sample size of 2, where df = n - 1)</span></span>
<span id="cb62-9"><a href="null-hypothesis-significance-testing.html#cb62-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">dt</span>(xvals, <span class="at">df=</span><span class="dv">1</span>), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb62-10"><a href="null-hypothesis-significance-testing.html#cb62-10" tabindex="-1"></a></span>
<span id="cb62-11"><a href="null-hypothesis-significance-testing.html#cb62-11" tabindex="-1"></a><span class="co"># as you increase the sample size, and hence the degrees of freedom, the t distribution</span></span>
<span id="cb62-12"><a href="null-hypothesis-significance-testing.html#cb62-12" tabindex="-1"></a><span class="co"># approaches, but never reaches, normal (though for most purposes, anything with</span></span>
<span id="cb62-13"><a href="null-hypothesis-significance-testing.html#cb62-13" tabindex="-1"></a><span class="co"># a sample size &gt;20 is probably fine to assume normality if it is generally normally</span></span>
<span id="cb62-14"><a href="null-hypothesis-significance-testing.html#cb62-14" tabindex="-1"></a><span class="co"># distributed and meets other assumptions)</span></span>
<span id="cb62-15"><a href="null-hypothesis-significance-testing.html#cb62-15" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">dt</span>(xvals, <span class="at">df=</span><span class="dv">5</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;tomato2&quot;</span>)</span>
<span id="cb62-16"><a href="null-hypothesis-significance-testing.html#cb62-16" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">dt</span>(xvals, <span class="at">df=</span><span class="dv">20</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;tomato2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>We will not spend much time on t-tests because quite frankly they are rarely useful in ecology (and the internet is chock-full of advice), but they can be useful if you want to know if two groups are different from each other.</p>
<div class="float">
<img src="https://pbs.twimg.com/media/EOGPlvJU8AIDLEV.jpg:large" alt="T-tests as illustrated by Alison Horst" />
<div class="figcaption">T-tests as illustrated by Alison Horst</div>
</div>
<div id="butterfly-wing-size" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Butterfly wing size<a href="null-hypothesis-significance-testing.html#butterfly-wing-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s say we have two species of butterflies, and we want to know if there is a significant difference in their forewing length. The data we are using for this example come from <a href="https://doi.org/10.1111/ecog.07075">Daly et al. (2024)</a>, who found that warming temperatures can affect development and eventual body size of Arctic butterflies. Here, we are not replicating their full analysis - we are just going to use the data to test if <em>Boloria chariclea</em> is larger than <em>Boloria freija</em> (a fascinating question, I know…).</p>
<div class="float">
<img src="https://nsojournals.onlinelibrary.wiley.com/cms/asset/ace47237-28e9-4e1e-b01a-c6e188e51852/ecog13112-fig-0003-m.jpg" alt="Figure from Daly et al. (2024) showing potential impacts of climate change on body size in ARctic butterflies" />
<div class="figcaption">Figure from Daly et al. (2024) showing potential impacts of climate change on body size in ARctic butterflies</div>
</div>
<p>Because we are working with external data, we need to get it into our environment. There are many different ways to import data depending on the type of file you are reading. In this case, I have exported <a href="https://doi.org/10.5061/dryad.4qrfj6qh1">their data from Dryad</a> and converted it to a comma separated value (.csv) file.</p>
<blockquote>
<p><strong>Future proofing your data files: </strong>When you can use .csv, it is highly, highly recommended because it is future proofed meaning it can be opened by any text editor (unlike e.g. .xlsx). There are of course other options for reading in things like tab-delimited files with <code>read.delim()</code> or Excel spreadsheets with <code>readxl::read.xlsx()</code> and so on, but a simple .csv is the way to go when possible.</p>
</blockquote>
<p>First, we should read in the data into our environment. Then, it is generally a good idea to explore your data to see what you are working with. The function <code>head</code> will show you, by default, the first six elements of an object (in this case, the first six rows because our object is of the class <code>data.frame</code>). The function <code>colnames</code> will give you the column names (<code>rownames</code> will give you the names of rows). It is also a good idea to look at the structure of your data with the <code>str</code> function which gives you a quick overview of what is contained in the object. For example, with this data, it will tell us we have 2501 observations (i.e. rows of data) of 19 variables (i.e. our columns). It will also tell us all the column names, what type of data are contained in the column (e.g. year is an integer, species is a character, etc.), and give a preview of the first few items in each column.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="null-hypothesis-significance-testing.html#cb63-1" tabindex="-1"></a><span class="co"># read in the spreadsheet to our environment</span></span>
<span id="cb63-2"><a href="null-hypothesis-significance-testing.html#cb63-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/daly2024_butterflysize.csv&quot;</span>)</span>
<span id="cb63-3"><a href="null-hypothesis-significance-testing.html#cb63-3" tabindex="-1"></a></span>
<span id="cb63-4"><a href="null-hypothesis-significance-testing.html#cb63-4" tabindex="-1"></a><span class="co"># note that if you have an internet connection, you can also read in data from </span></span>
<span id="cb63-5"><a href="null-hypothesis-significance-testing.html#cb63-5" tabindex="-1"></a><span class="co"># remote sources. e.g. I uploaded this spreadsheet as a publicly available</span></span>
<span id="cb63-6"><a href="null-hypothesis-significance-testing.html#cb63-6" tabindex="-1"></a><span class="co"># .csv via Google Sheets and you could read it in from there instead of from</span></span>
<span id="cb63-7"><a href="null-hypothesis-significance-testing.html#cb63-7" tabindex="-1"></a><span class="co"># a local archive</span></span>
<span id="cb63-8"><a href="null-hypothesis-significance-testing.html#cb63-8" tabindex="-1"></a></span>
<span id="cb63-9"><a href="null-hypothesis-significance-testing.html#cb63-9" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://tinyurl.com/daly2024&quot;</span>) </span>
<span id="cb63-10"><a href="null-hypothesis-significance-testing.html#cb63-10" tabindex="-1"></a></span>
<span id="cb63-11"><a href="null-hypothesis-significance-testing.html#cb63-11" tabindex="-1"></a><span class="co"># look at the first few rows of data</span></span>
<span id="cb63-12"><a href="null-hypothesis-significance-testing.html#cb63-12" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>##   year      barcode box.barcode   box     envelope Species.determined.by
## 1 1971 UAM100190600      C87023 53-01 UAM100190576   Jayce B. Williamson
## 2 1971 UAM100190625      C87023 53-01 UAM100190573   Jayce B. Williamson
## 3 1971 UAM100190626      C87023 53-01 UAM100190573   Jayce B. Williamson
## 4 1971 UAM100190627      C87023 53-01 UAM100190573   Jayce B. Williamson
## 5 1971 UAM100190639      C87023 53-01 UAM100190570   Jayce B. Williamson
## 6 1971 UAM100190640      C87023 53-01 UAM100190561   Jayce B. Williamson
##             species length            measurer region sex
## 1 Boloria chariclea  18.70     Abby Blackstone      W   M
## 2 Boloria chariclea  16.50 Elizabeth Himschoot      W   M
## 3 Boloria chariclea  16.48 Elizabeth Himschoot      W   M
## 4 Boloria chariclea  16.41 Elizabeth Himschoot      W   M
## 5 Boloria chariclea  16.70 Elizabeth Himschoot      W   M
## 6 Boloria chariclea  18.16 Elizabeth Himschoot      W   M
##   Previous.Summer.Station Spring.weather.station extrap_station extrap_gdd0
## 1                    brrw                   brrw  brrw.nk.ko.at    917.7636
## 2                    brrw                   brrw  brrw.nk.ko.at    917.7636
## 3                    brrw                   brrw  brrw.nk.ko.at    917.7636
## 4                    brrw                   brrw  brrw.nk.ko.at    917.7636
## 5                    brrw                   brrw  brrw.nk.ko.at    917.7636
## 6                    brrw                   brrw  brrw.nk.ko.at    917.7636
##   extrap_gdd5 flight_doy_cutoff prev_summer_gdd spring_gdd
## 1    679.3685               180           61.66      20.28
## 2    679.3685               180           61.66      20.28
## 3    679.3685               180           61.66      20.28
## 4    679.3685               180           61.66      20.28
## 5    679.3685               180           61.66      20.28
## 6    679.3685               180           61.66      20.28</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="null-hypothesis-significance-testing.html#cb65-1" tabindex="-1"></a><span class="co"># what are all the column names?</span></span>
<span id="cb65-2"><a href="null-hypothesis-significance-testing.html#cb65-2" tabindex="-1"></a><span class="fu">colnames</span>(dat)</span></code></pre></div>
<pre><code>##  [1] &quot;year&quot;                    &quot;barcode&quot;                
##  [3] &quot;box.barcode&quot;             &quot;box&quot;                    
##  [5] &quot;envelope&quot;                &quot;Species.determined.by&quot;  
##  [7] &quot;species&quot;                 &quot;length&quot;                 
##  [9] &quot;measurer&quot;                &quot;region&quot;                 
## [11] &quot;sex&quot;                     &quot;Previous.Summer.Station&quot;
## [13] &quot;Spring.weather.station&quot;  &quot;extrap_station&quot;         
## [15] &quot;extrap_gdd0&quot;             &quot;extrap_gdd5&quot;            
## [17] &quot;flight_doy_cutoff&quot;       &quot;prev_summer_gdd&quot;        
## [19] &quot;spring_gdd&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="null-hypothesis-significance-testing.html#cb67-1" tabindex="-1"></a><span class="co"># often, it is also a good idea to look at the structure</span></span>
<span id="cb67-2"><a href="null-hypothesis-significance-testing.html#cb67-2" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2501 obs. of  19 variables:
##  $ year                   : int  1971 1971 1971 1971 1971 1971 1971 1971 1971 1971 ...
##  $ barcode                : chr  &quot;UAM100190600&quot; &quot;UAM100190625&quot; &quot;UAM100190626&quot; &quot;UAM100190627&quot; ...
##  $ box.barcode            : chr  &quot;C87023&quot; &quot;C87023&quot; &quot;C87023&quot; &quot;C87023&quot; ...
##  $ box                    : chr  &quot;53-01&quot; &quot;53-01&quot; &quot;53-01&quot; &quot;53-01&quot; ...
##  $ envelope               : chr  &quot;UAM100190576&quot; &quot;UAM100190573&quot; &quot;UAM100190573&quot; &quot;UAM100190573&quot; ...
##  $ Species.determined.by  : chr  &quot;Jayce B. Williamson&quot; &quot;Jayce B. Williamson&quot; &quot;Jayce B. Williamson&quot; &quot;Jayce B. Williamson&quot; ...
##  $ species                : chr  &quot;Boloria chariclea&quot; &quot;Boloria chariclea&quot; &quot;Boloria chariclea&quot; &quot;Boloria chariclea&quot; ...
##  $ length                 : num  18.7 16.5 16.5 16.4 16.7 ...
##  $ measurer               : chr  &quot;Abby Blackstone&quot; &quot;Elizabeth Himschoot&quot; &quot;Elizabeth Himschoot&quot; &quot;Elizabeth Himschoot&quot; ...
##  $ region                 : chr  &quot;W&quot; &quot;W&quot; &quot;W&quot; &quot;W&quot; ...
##  $ sex                    : chr  &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; ...
##  $ Previous.Summer.Station: chr  &quot;brrw&quot; &quot;brrw&quot; &quot;brrw&quot; &quot;brrw&quot; ...
##  $ Spring.weather.station : chr  &quot;brrw&quot; &quot;brrw&quot; &quot;brrw&quot; &quot;brrw&quot; ...
##  $ extrap_station         : chr  &quot;brrw.nk.ko.at&quot; &quot;brrw.nk.ko.at&quot; &quot;brrw.nk.ko.at&quot; &quot;brrw.nk.ko.at&quot; ...
##  $ extrap_gdd0            : num  918 918 918 918 918 ...
##  $ extrap_gdd5            : num  679 679 679 679 679 ...
##  $ flight_doy_cutoff      : int  180 180 180 180 180 180 180 180 180 180 ...
##  $ prev_summer_gdd        : num  61.7 61.7 61.7 61.7 61.7 ...
##  $ spring_gdd             : num  20.3 20.3 20.3 20.3 20.3 ...</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="null-hypothesis-significance-testing.html#cb69-1" tabindex="-1"></a><span class="co"># notice that different columns in the data.frame have different data types</span></span>
<span id="cb69-2"><a href="null-hypothesis-significance-testing.html#cb69-2" tabindex="-1"></a><span class="co"># e.g. year is an integer, species is a character (chr), previous summer growing</span></span>
<span id="cb69-3"><a href="null-hypothesis-significance-testing.html#cb69-3" tabindex="-1"></a><span class="co"># degree days (prev_summer_gdd) is numeric, etc.</span></span></code></pre></div>
<p>But, back to the main point here: doing a quick t-test to see if the two species are different sizes. First, let’s ask the question “Are <em>Boloria chariclea</em> and <em>Boloria freija</em> significantly different in size?”. Notice here that we do not specify which is larger - just that they are different.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="null-hypothesis-significance-testing.html#cb70-1" tabindex="-1"></a><span class="co"># create a vector of only the sizes (length) of B freija</span></span>
<span id="cb70-2"><a href="null-hypothesis-significance-testing.html#cb70-2" tabindex="-1"></a><span class="co"># and the same for chariclea</span></span>
<span id="cb70-3"><a href="null-hypothesis-significance-testing.html#cb70-3" tabindex="-1"></a>freija <span class="ot">&lt;-</span> dat<span class="sc">$</span>length[dat<span class="sc">$</span>species<span class="sc">==</span><span class="st">&quot;Boloria freija&quot;</span>]</span>
<span id="cb70-4"><a href="null-hypothesis-significance-testing.html#cb70-4" tabindex="-1"></a>chariclea <span class="ot">&lt;-</span> dat<span class="sc">$</span>length[dat<span class="sc">$</span>species<span class="sc">==</span><span class="st">&quot;Boloria chariclea&quot;</span>]</span>
<span id="cb70-5"><a href="null-hypothesis-significance-testing.html#cb70-5" tabindex="-1"></a></span>
<span id="cb70-6"><a href="null-hypothesis-significance-testing.html#cb70-6" tabindex="-1"></a><span class="co"># use a t-test to test if they are different</span></span>
<span id="cb70-7"><a href="null-hypothesis-significance-testing.html#cb70-7" tabindex="-1"></a><span class="fu">t.test</span>(freija, chariclea)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  freija and chariclea
## t = -8.4521, df = 1895.9, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.5197503 -0.3239729
## sample estimates:
## mean of x mean of y 
##  17.46234  17.88420</code></pre>
<p>For identification purposes, it is potentially good to know that the species can be distinguished by size. But imagine telling a field technician that they can tell them apart because they are different sizes. The first question they will ask is which one is bigger.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="null-hypothesis-significance-testing.html#cb72-1" tabindex="-1"></a><span class="co"># plot the distribution of sizes for the two species side by side</span></span>
<span id="cb72-2"><a href="null-hypothesis-significance-testing.html#cb72-2" tabindex="-1"></a></span>
<span id="cb72-3"><a href="null-hypothesis-significance-testing.html#cb72-3" tabindex="-1"></a><span class="fu">hist</span>(freija, <span class="at">col=</span><span class="st">&quot;#ffaa0088&quot;</span>, <span class="co"># you can specify colors in RGB format, including opacity</span></span>
<span id="cb72-4"><a href="null-hypothesis-significance-testing.html#cb72-4" tabindex="-1"></a>     <span class="at">border=</span>F,</span>
<span id="cb72-5"><a href="null-hypothesis-significance-testing.html#cb72-5" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>), <span class="co"># in case the other species needs more room on the axis</span></span>
<span id="cb72-6"><a href="null-hypothesis-significance-testing.html#cb72-6" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">50</span>)</span>
<span id="cb72-7"><a href="null-hypothesis-significance-testing.html#cb72-7" tabindex="-1"></a><span class="fu">hist</span>(chariclea, <span class="at">col=</span><span class="st">&quot;#ff000044&quot;</span>, <span class="at">border=</span>F,</span>
<span id="cb72-8"><a href="null-hypothesis-significance-testing.html#cb72-8" tabindex="-1"></a>     <span class="at">add=</span>T, <span class="co"># add it to the current plot set to TRUE</span></span>
<span id="cb72-9"><a href="null-hypothesis-significance-testing.html#cb72-9" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">50</span>)</span>
<span id="cb72-10"><a href="null-hypothesis-significance-testing.html#cb72-10" tabindex="-1"></a></span>
<span id="cb72-11"><a href="null-hypothesis-significance-testing.html#cb72-11" tabindex="-1"></a><span class="co"># add a legend to remind ourselves which color is which</span></span>
<span id="cb72-12"><a href="null-hypothesis-significance-testing.html#cb72-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="co"># placement</span></span>
<span id="cb72-13"><a href="null-hypothesis-significance-testing.html#cb72-13" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;B. freija&quot;</span>, <span class="st">&quot;B. chariclea&quot;</span>), <span class="co">#text</span></span>
<span id="cb72-14"><a href="null-hypothesis-significance-testing.html#cb72-14" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#ffaa00&quot;</span>, <span class="st">&quot;#ff0000&quot;</span>), <span class="co"># colors</span></span>
<span id="cb72-15"><a href="null-hypothesis-significance-testing.html#cb72-15" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">15</span>, <span class="co"># character</span></span>
<span id="cb72-16"><a href="null-hypothesis-significance-testing.html#cb72-16" tabindex="-1"></a>       <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="co"># i do not like boxes</span></span>
<span id="cb72-17"><a href="null-hypothesis-significance-testing.html#cb72-17" tabindex="-1"></a>       <span class="at">pt.cex=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="null-hypothesis-significance-testing.html#cb73-1" tabindex="-1"></a><span class="co"># looks like chariclea is slightly larger</span></span></code></pre></div>
<p>Earlier, we did a two-tailed t-test with an <span class="math inline">\(\alpha\)</span> of 0.05, meaning we only cared if the probability of observing the difference in size that we observed, or an even greater difference, was less than 5%, if the null hypothesis that there was no difference in size was true. But, we could also do a one-tailed test, which would help us answer the question: Is <em>Boloria chariclea</em> larger than <em>Boloria freija</em>? Here, we introduce the idea that we only care about one side (the upper tail) of the t-distribution, not the lower.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="null-hypothesis-significance-testing.html#cb74-1" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: it matters which species is x and which is y! In this line, we are asking if</span></span>
<span id="cb74-2"><a href="null-hypothesis-significance-testing.html#cb74-2" tabindex="-1"></a><span class="co"># chariclea is larger than freija, and the result is yes</span></span>
<span id="cb74-3"><a href="null-hypothesis-significance-testing.html#cb74-3" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> chariclea, <span class="at">y =</span> freija, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  chariclea and freija
## t = 8.4521, df = 1895.9, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  0.3397231       Inf
## sample estimates:
## mean of x mean of y 
##  17.88420  17.46234</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="null-hypothesis-significance-testing.html#cb76-1" tabindex="-1"></a><span class="co"># but, if we ask in a one-sided test if freija is larger than chariclea, it is no</span></span>
<span id="cb76-2"><a href="null-hypothesis-significance-testing.html#cb76-2" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> freija, <span class="at">y =</span> chariclea, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  freija and chariclea
## t = -8.4521, df = 1895.9, p-value = 1
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -0.5040001        Inf
## sample estimates:
## mean of x mean of y 
##  17.46234  17.88420</code></pre>
<p>There are also paired t-tests in which you have a paired set of observations of one thing, and you want to know if they as a group differ from a paired set of observations of another thing. To do this, add the argument <code>paired=T</code> to the <code>t.test</code> function, but each of your vectors will need to actually be paired (i.e. identical length).</p>
<p>With our <em>Boloria</em> data, let’s say for some reason we wanted to know if the mean size of <em>Boloria chariclea</em> was larger than <em>Boloria freija</em> every single year in the study, and we wanted to do the comparisons year by year. Not a very sensible question to ask from a biological perspective unless we thought that there were large differences across years, but that’s our example data this week, so we will go with it.</p>
<p>First, we will need to do some data wrangling to get our data into the format we want. What we want is a mean value for each year for each species. We can use the <code>aggregate</code> function for this. There are also <code>tidyverse</code> ways to group and summarize data, which we will not talk about in this course because I prefer base.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="null-hypothesis-significance-testing.html#cb78-1" tabindex="-1"></a><span class="co"># don&#39;t forget you can look up what arguments a function expects with ?</span></span>
<span id="cb78-2"><a href="null-hypothesis-significance-testing.html#cb78-2" tabindex="-1"></a>mean_wts <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(length <span class="sc">~</span> year <span class="sc">+</span> species, <span class="at">data=</span>dat, <span class="at">FUN=</span>mean)</span>
<span id="cb78-3"><a href="null-hypothesis-significance-testing.html#cb78-3" tabindex="-1"></a></span>
<span id="cb78-4"><a href="null-hypothesis-significance-testing.html#cb78-4" tabindex="-1"></a><span class="co"># this gives us the mean for each species in each year, but we want it in a</span></span>
<span id="cb78-5"><a href="null-hypothesis-significance-testing.html#cb78-5" tabindex="-1"></a><span class="co"># format where each row contains observations for comparison; we can move it to</span></span>
<span id="cb78-6"><a href="null-hypothesis-significance-testing.html#cb78-6" tabindex="-1"></a><span class="co"># this form with the xtabs function</span></span>
<span id="cb78-7"><a href="null-hypothesis-significance-testing.html#cb78-7" tabindex="-1"></a></span>
<span id="cb78-8"><a href="null-hypothesis-significance-testing.html#cb78-8" tabindex="-1"></a>yearly_wts <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(length <span class="sc">~</span> ., <span class="at">data=</span>mean_wts)</span>
<span id="cb78-9"><a href="null-hypothesis-significance-testing.html#cb78-9" tabindex="-1"></a></span>
<span id="cb78-10"><a href="null-hypothesis-significance-testing.html#cb78-10" tabindex="-1"></a><span class="co"># now we have vectors of the same length for comparison with a paired t-test</span></span>
<span id="cb78-11"><a href="null-hypothesis-significance-testing.html#cb78-11" tabindex="-1"></a><span class="co"># note you do not always need these steps, it depends on your data structure</span></span>
<span id="cb78-12"><a href="null-hypothesis-significance-testing.html#cb78-12" tabindex="-1"></a></span>
<span id="cb78-13"><a href="null-hypothesis-significance-testing.html#cb78-13" tabindex="-1"></a><span class="fu">t.test</span>(yearly_wts[,<span class="dv">1</span>], yearly_wts[,<span class="dv">2</span>], <span class="at">paired=</span>T, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  yearly_wts[, 1] and yearly_wts[, 2]
## t = 0.35052, df = 14, p-value = 0.3656
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -2.307567       Inf
## sample estimates:
## mean of the differences 
##               0.5733311</code></pre>
<p>A more practical example of where I’ve used this is to test if there have been phenological shifts in the week of last flight for moths in Ithaca. Each species is only represented once in the historical data, and once in the current data. To see if the whole community is flying later, we used a paired t-test because that way each species was matched up with its own data point historically and now, rather than having a lumped distribution of data historically and a lumped distribution currently. Or, perhaps you have a before and after experimental design setup and want to know if your experimental units have changed in response to a treatment. For example, you have 20 streams and you measure their invertebrate species richness, then introduce standing deadwood to the streams and want to know how it changed the invertebrate community. You do not want to compare the streams to each other - you want to compare each to their previous invertebrate community, so you have pairwise samples.</p>
</div>
</div>
<div id="anova" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> ANOVA<a href="null-hypothesis-significance-testing.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What if instead of comparing two groups, we wanted to compare three or more groups? That’s called an analysis of variance (ANOVA).</p>
<p>The dataset we read in earlier actually has three different species and also includes <em>Colias hecla</em>. For no real scientific reason whatsoever, we will ask the question: are these three butterfly species different in size?</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="null-hypothesis-significance-testing.html#cb80-1" tabindex="-1"></a><span class="co"># we use the aov function, and here we will specify our data a bit differently</span></span>
<span id="cb80-2"><a href="null-hypothesis-significance-testing.html#cb80-2" tabindex="-1"></a><span class="co"># instead of putting in two separate species vectors, we will use the tilde ~</span></span>
<span id="cb80-3"><a href="null-hypothesis-significance-testing.html#cb80-3" tabindex="-1"></a><span class="co"># to indicate that we want to model the response variable (length) over the</span></span>
<span id="cb80-4"><a href="null-hypothesis-significance-testing.html#cb80-4" tabindex="-1"></a><span class="co"># categorical groups (species) in our dataset (dat)</span></span>
<span id="cb80-5"><a href="null-hypothesis-significance-testing.html#cb80-5" tabindex="-1"></a>size_mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(length <span class="sc">~</span> species, <span class="at">data =</span> dat)</span>
<span id="cb80-6"><a href="null-hypothesis-significance-testing.html#cb80-6" tabindex="-1"></a></span>
<span id="cb80-7"><a href="null-hypothesis-significance-testing.html#cb80-7" tabindex="-1"></a><span class="co"># we saved this output to an object, because typically you want to actually be</span></span>
<span id="cb80-8"><a href="null-hypothesis-significance-testing.html#cb80-8" tabindex="-1"></a><span class="co"># able to work with your model output, not just run it once and do nothing</span></span>
<span id="cb80-9"><a href="null-hypothesis-significance-testing.html#cb80-9" tabindex="-1"></a><span class="co"># the summary() function applied to the model will give us the results</span></span>
<span id="cb80-10"><a href="null-hypothesis-significance-testing.html#cb80-10" tabindex="-1"></a><span class="fu">summary</span>(size_mod)</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)    
## species        2  10964    5482    4086 &lt;2e-16 ***
## Residuals   2497   3350       1                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 1 observation deleted due to missingness</code></pre>
<p>The model summary tells us that there are significant differences between the three species, but do we know if that’s because one is much bigger (or smaller) than the others, or that they are all different from each other. To see what differences resulted in a significant difference in the overall model, we can use Tukey’s Honestly Significant Differences, which will give us the difference between the groups, the lower and upper bound of the difference, and the p-value associated with that difference. Note that if the lower and upper bounds of the difference overlap zero, then we would not know if there was a difference between the two groups. That is another way to think about p-values and significance (assuming 0 difference is your null hypothesis). These upper and lower values are confidence intervals.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="null-hypothesis-significance-testing.html#cb82-1" tabindex="-1"></a><span class="fu">TukeyHSD</span>(size_mod)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = length ~ species, data = dat)
## 
## $species
##                                        diff        lwr       upr p adj
## Boloria freija-Boloria chariclea -0.4218616 -0.5462763 -0.297447     0
## Colias hecla-Boloria chariclea    4.6964363  4.5547907  4.838082     0
## Colias hecla-Boloria freija       5.1182979  4.9758238  5.260772     0</code></pre>
</div>
<div id="type-i-and-type-ii-error" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Type I and Type II error<a href="null-hypothesis-significance-testing.html#type-i-and-type-ii-error" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When doing null hypothesis significance testing (NHST) with different thresholds of <span class="math inline">\(\alpha\)</span>, remember that we only either reject or fail to reject the null. But, we also know that our p-values are the probability of observing our data, or data more extreme, if the null were true. This means that there is always a non-zero chance of observing your data and rejecting the null <em>even if the null is true</em>. If we reject the null when it is true, this is a false positive (i.e. we have identified a relationship or difference in our data that does not actually exist) or a type I error. The probability of making a type I error is our <span class="math inline">\(\alpha\)</span> threshold. When setting a threshold for <span class="math inline">\(\alpha\)</span>, what we are really asking ourselves is ‘what probability am I okay with as an upper bound for claiming something is true when it is not?’ Conversely, a type II error is when we fail to reject the null even though the null is false (i.e. a false negative, we say there is no difference when there really is). The probability of making a type II error is denoted <span class="math inline">\(\beta\)</span> and represents the chance that we will miss an association or effect that truly exists. <span class="math inline">\(1 - \beta\)</span> is the ‘power’ of our test.</p>
<div class="float">
<img src="https://miro.medium.com/v2/resize:fit:1400/0*9xnNK1z-rLOHBTlw.jpg" alt="Type I vs Type II error" />
<div class="figcaption">Type I vs Type II error</div>
</div>
<p>When planning research, it is helpful to know if you will likely be able to detect the effect that you expect exists in the population, which partly depends on sample size. Power analysis is an approach to estimate what sample size you will need, what effect is possible to detect with your data, or what power you have to detect an observed effect given your data. Note that the last one is typically done post-hoc to ‘explain’ negative results and is bad scientific practice; do not do post-hoc power analyses. For t-tests, there is a built-in function in R to do power analysis called <code>power.t.test</code>. Using this function, what is the chance, given our data, that we will make a type II error when comparing <em>Boloria chariclea</em> to <em>B. freija</em> wing length?</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="null-hypothesis-significance-testing.html#cb84-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb84-2"><a href="null-hypothesis-significance-testing.html#cb84-2" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(dat<span class="sc">$</span>length)</span>
<span id="cb84-3"><a href="null-hypothesis-significance-testing.html#cb84-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb84-4"><a href="null-hypothesis-significance-testing.html#cb84-4" tabindex="-1"></a>meandiff <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>length[dat<span class="sc">$</span>species<span class="sc">==</span><span class="st">&quot;Boloria chariclea&quot;</span>], <span class="at">na.rm=</span>T) <span class="sc">-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>length[dat<span class="sc">$</span>species<span class="sc">==</span><span class="st">&quot;Boloria freija&quot;</span>], <span class="at">na.rm=</span>T)</span>
<span id="cb84-5"><a href="null-hypothesis-significance-testing.html#cb84-5" tabindex="-1"></a></span>
<span id="cb84-6"><a href="null-hypothesis-significance-testing.html#cb84-6" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n =</span> N, <span class="at">delta =</span> meandiff, <span class="at">sig.level =</span> alpha)</span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 1250.5
##           delta = 0.4218616
##              sd = 1
##       sig.level = 0.05
##           power = 1
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="null-hypothesis-significance-testing.html#cb86-1" tabindex="-1"></a><span class="co"># What if we only sampled 20 individuals of each species?</span></span>
<span id="cb86-2"><a href="null-hypothesis-significance-testing.html#cb86-2" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">delta =</span> meandiff, <span class="at">sig.level =</span> alpha)</span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 20
##           delta = 0.4218616
##              sd = 1
##       sig.level = 0.05
##           power = 0.2547824
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>Power analysis can be especially useful if you are doing destructive or lethal sampling because you can use it to estimate the minimum number of samples or individuals you need to sacrifice to detect different thresholds. For instance, let’s say we were <a href="https://journals.biologists.com/jeb/article/225/10/jeb243294/275376/Anna-s-hummingbird-Calypte-anna-physiological">collecting hummingbirds from high elevation and low elevation sites, bringing them to a common location, measuring their metabolic rates, and then sacrificing them to weigh their internal organs</a>. Naturally, we would want to sacrifice as few individuals as possible. If we wanted 80% power to detect an effect size difference of 0.2 between individuals from low and high elevation sites with a probability of a false positive of 5%, how many hummingbirds would we need? What if we weren’t sure about the effect and we thought it might be between 0.1 and 0.8?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="null-hypothesis-significance-testing.html#cb88-1" tabindex="-1"></a>possible_effects <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="at">by=</span><span class="fl">0.05</span>)</span>
<span id="cb88-2"><a href="null-hypothesis-significance-testing.html#cb88-2" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb88-3"><a href="null-hypothesis-significance-testing.html#cb88-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(possible_effects)){</span>
<span id="cb88-4"><a href="null-hypothesis-significance-testing.html#cb88-4" tabindex="-1"></a>  power1 <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">delta=</span>possible_effects[i], <span class="at">sd=</span><span class="dv">1</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="fl">0.20</span>)</span>
<span id="cb88-5"><a href="null-hypothesis-significance-testing.html#cb88-5" tabindex="-1"></a>  sample_size[i] <span class="ot">&lt;-</span> power1<span class="sc">$</span>n</span>
<span id="cb88-6"><a href="null-hypothesis-significance-testing.html#cb88-6" tabindex="-1"></a>}</span>
<span id="cb88-7"><a href="null-hypothesis-significance-testing.html#cb88-7" tabindex="-1"></a></span>
<span id="cb88-8"><a href="null-hypothesis-significance-testing.html#cb88-8" tabindex="-1"></a><span class="fu">plot</span>(sample_size <span class="sc">~</span> possible_effects, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
