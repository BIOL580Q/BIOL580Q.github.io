<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2.2 Binomial distribution | BIOL 480/580Q: Ecological Modeling (Fall 2024)" />
<meta property="og:type" content="book" />




<meta name="author" content="Eliza Grames" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="2.2 Binomial distribution | BIOL 480/580Q: Ecological Modeling (Fall 2024)">

<title>2.2 Binomial distribution | BIOL 480/580Q: Ecological Modeling (Fall 2024)</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>




</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="1.1-about-this-book.html#about-this-book" id="toc-about-this-book"><span class="toc-section-number">1.1</span> About this ‘book’</a></li>
<li><a href="1.2-why-this-course.html#why-this-course" id="toc-why-this-course"><span class="toc-section-number">1.2</span> Why this course?</a></li>
<li class="has-sub"><a href="1.3-getting-comfortable-with-r-and-rstudio.html#getting-comfortable-with-r-and-rstudio" id="toc-getting-comfortable-with-r-and-rstudio"><span class="toc-section-number">1.3</span> Getting comfortable with R and RStudio</a>
<ul>
<li><a href="1.3-getting-comfortable-with-r-and-rstudio.html#some-terms-and-definitions" id="toc-some-terms-and-definitions"><span class="toc-section-number">1.3.1</span> Some terms and definitions</a></li>
<li><a href="1.3-getting-comfortable-with-r-and-rstudio.html#customizing-rstudio" id="toc-customizing-rstudio"><span class="toc-section-number">1.3.2</span> Customizing RStudio</a></li>
</ul></li>
<li><a href="1.4-how-to-approach-this-course.html#how-to-approach-this-course" id="toc-how-to-approach-this-course"><span class="toc-section-number">1.4</span> How to approach this course</a></li>
</ul></li>
<li class="has-sub"><a href="2-probability.html#probability" id="toc-probability"><span class="toc-section-number">2</span> Probability</a>
<ul>
<li><a href="2.1-bernoulli-distribution.html#bernoulli-distribution" id="toc-bernoulli-distribution"><span class="toc-section-number">2.1</span> Bernoulli distribution</a></li>
<li class="has-sub"><a href="2.2-binomial-distribution.html#binomial-distribution" id="toc-binomial-distribution"><span class="toc-section-number">2.2</span> Binomial distribution</a>
<ul>
<li><a href="2.2-binomial-distribution.html#guillemot-example" id="toc-guillemot-example"><span class="toc-section-number">2.2.1</span> Guillemot example</a></li>
<li><a href="2.2-binomial-distribution.html#coral-example" id="toc-coral-example"><span class="toc-section-number">2.2.2</span> Coral example</a></li>
</ul></li>
<li><a href="2.3-probability-mass.html#probability-mass" id="toc-probability-mass"><span class="toc-section-number">2.3</span> Probability mass</a></li>
<li class="has-sub"><a href="2.4-the-normal-gaussian-distribution.html#the-normal-gaussian-distribution" id="toc-the-normal-gaussian-distribution"><span class="toc-section-number">2.4</span> The Normal (Gaussian) distribution</a>
<ul>
<li><a href="2.4-the-normal-gaussian-distribution.html#guillemot-weight" id="toc-guillemot-weight"><span class="toc-section-number">2.4.1</span> Guillemot weight</a></li>
</ul></li>
<li><a href="2.5-probability-density.html#probability-density" id="toc-probability-density"><span class="toc-section-number">2.5</span> Probability density</a></li>
<li class="has-sub"><a href="2.6-the-standard-normal-distribution.html#the-standard-normal-distribution" id="toc-the-standard-normal-distribution"><span class="toc-section-number">2.6</span> The Standard Normal Distribution</a>
<ul>
<li><a href="2.6-the-standard-normal-distribution.html#functions-1" id="toc-functions-1"><span class="toc-section-number">2.6.1</span> Functions</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="binomial-distribution" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Binomial distribution</h2>
<div id="guillemot-example" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Guillemot example</h3>
<p>Guillemots typically only lay 1-2 eggs, but for the sake of our example code, let’s pretend that each pair has 3 chicks that are attempting to make it to the ocean. Each individual chick’s attempt could be modeled with a Bernoulli distribution, but if we consider it from the perspective of the breeding pair, the total number of surviving offspring is what matters. We can think of the number of chicks from each nest that make it to the ocean as the sum of their individual attempts for a single nest. This is the Binomial distribution, which is a more generalized version of the Bernoulli distribution (more accurately, the Bernoulli distribution is a special case of the Binomial distribution with one draw) in which each observation has multiple draws.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="2.2-binomial-distribution.html#cb10-1" tabindex="-1"></a><span class="co"># for one nest with 3 chicks and a probability of success of 0.4</span></span>
<span id="cb10-2"><a href="2.2-binomial-distribution.html#cb10-2" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="2.2-binomial-distribution.html#cb12-1" tabindex="-1"></a><span class="co"># we could also think about a colony with let&#39;s say 100 nests</span></span>
<span id="cb12-2"><a href="2.2-binomial-distribution.html#cb12-2" tabindex="-1"></a><span class="co"># how many chicks from each nest will make it?</span></span>
<span id="cb12-3"><a href="2.2-binomial-distribution.html#cb12-3" tabindex="-1"></a>nest_offspring <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb12-4"><a href="2.2-binomial-distribution.html#cb12-4" tabindex="-1"></a><span class="fu">hist</span>(nest_offspring)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672"  /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="2.2-binomial-distribution.html#cb13-1" tabindex="-1"></a>nest_offspring</span></code></pre></div>
<pre><code>##   [1] 1 1 1 0 2 2 1 1 1 0 1 1 0 0 2 2 0 1 2 1 0 1 3 1 2 0 1 2 0 1 3 3 0 1 0 1 1
##  [38] 2 2 0 1 1 0 0 0 2 0 1 1 0 1 0 1 1 0 1 2 0 0 0 2 0 0 1 2 3 1 1 2 1 1 1 1 1
##  [75] 1 1 0 1 1 0 0 1 2 2 1 3 0 1 0 1 2 0 1 1 1 0 1 2 2 0</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="2.2-binomial-distribution.html#cb15-1" tabindex="-1"></a><span class="co"># what is the probability that all three chicks from a nest make it?</span></span>
<span id="cb15-2"><a href="2.2-binomial-distribution.html#cb15-2" tabindex="-1"></a><span class="co"># because we know what we fixed p to, we could multiply the probabilities</span></span>
<span id="cb15-3"><a href="2.2-binomial-distribution.html#cb15-3" tabindex="-1"></a><span class="fl">0.4</span><span class="sc">^</span><span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] 0.064</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="2.2-binomial-distribution.html#cb17-1" tabindex="-1"></a><span class="co"># what is the probability that none make it?</span></span>
<span id="cb17-2"><a href="2.2-binomial-distribution.html#cb17-2" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.4</span>)<span class="sc">^</span><span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] 0.216</code></pre>
<p>We are able to calculate what the probability of these outcomes are because we fixed the probability of success at 0.4 and then simulated outcomes. In the real world, we rarely know what the probability of success truly is, and instead we are working backwards from our observed outcomes (i.e. our data) to estimate the probability of survival. One of the beautiful things about working with simulated data is that we know the input value, so we can test assumptions, see if we recapture our input, and play around with different model structures and know that anything that is unexpected is most likely a problem with our code or model, not the data.</p>
<p>With discrete distributions like the Binomial, we can convert the frequency of outcomes to a proportion of the total as an estimate of probability. Dividing the frequencies by the total sample size makes it so that the total probability sums to 1.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="2.2-binomial-distribution.html#cb19-1" tabindex="-1"></a><span class="co"># table is a function that tallies up all the items in a vector</span></span>
<span id="cb19-2"><a href="2.2-binomial-distribution.html#cb19-2" tabindex="-1"></a><span class="co"># a vector is a type of object that is one dimension, i.e. nest_offspring is a </span></span>
<span id="cb19-3"><a href="2.2-binomial-distribution.html#cb19-3" tabindex="-1"></a><span class="co"># vector with length = 100</span></span>
<span id="cb19-4"><a href="2.2-binomial-distribution.html#cb19-4" tabindex="-1"></a><span class="fu">table</span>(nest_offspring)</span></code></pre></div>
<pre><code>## nest_offspring
##  0  1  2  3 
## 31 45 19  5</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="2.2-binomial-distribution.html#cb21-1" tabindex="-1"></a><span class="co"># proportions will convert the table into proportions instead of counts</span></span>
<span id="cb21-2"><a href="2.2-binomial-distribution.html#cb21-2" tabindex="-1"></a><span class="co"># so will prop.table and I often use that function because I learned it first</span></span>
<span id="cb21-3"><a href="2.2-binomial-distribution.html#cb21-3" tabindex="-1"></a><span class="co"># there are many different ways to accomplish the same goal in R</span></span>
<span id="cb21-4"><a href="2.2-binomial-distribution.html#cb21-4" tabindex="-1"></a>survival_prob <span class="ot">&lt;-</span> <span class="fu">proportions</span>(<span class="fu">table</span>(nest_offspring))</span>
<span id="cb21-5"><a href="2.2-binomial-distribution.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="2.2-binomial-distribution.html#cb21-6" tabindex="-1"></a><span class="co"># How do these values compare to the calculated probability of all three chicks</span></span>
<span id="cb21-7"><a href="2.2-binomial-distribution.html#cb21-7" tabindex="-1"></a><span class="co"># surviving? What about of none surviving?</span></span>
<span id="cb21-8"><a href="2.2-binomial-distribution.html#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="2.2-binomial-distribution.html#cb21-9" tabindex="-1"></a><span class="co"># With the values calculated from the simulated data (i.e. not the parameter</span></span>
<span id="cb21-10"><a href="2.2-binomial-distribution.html#cb21-10" tabindex="-1"></a><span class="co"># value that we fixed), what is the probability that *at least* one chick </span></span>
<span id="cb21-11"><a href="2.2-binomial-distribution.html#cb21-11" tabindex="-1"></a><span class="co"># from a nest survives?</span></span>
<span id="cb21-12"><a href="2.2-binomial-distribution.html#cb21-12" tabindex="-1"></a><span class="fl">0.47</span> <span class="sc">+</span> <span class="fl">0.27</span> <span class="sc">+</span> <span class="fl">0.06</span> <span class="co"># note: numbers might be different because we didn&#39;t set.seed()</span></span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
<p>In general with coding, you want to avoid hard coding like this where you put in fixed values. It is much better to use code that is flexible if the input data changes (e.g. we are using a randomly generated dataset, so it will change every time), or if you want to change some parameter across a lot of different parts of the code. For example, instead of repeatedly typing p=0.4, we could have created an object in our environment with the probability of success such as <code>p.surv &lt;- 0.4</code> and then specifying p=p.surv throughout the script, which would make it really easy to change the simulations for a new scenario (e.g. if the guillemot chicks were given little hang-gliders, we might increase p.surv and would only have to type it out once as <code>p.surv &lt;- 0.8</code>.</p>
<p>Subsetting vectors in R is a really useful tool when you want to apply a function to only part of a vector, inspect part of an object, etc. We use the square brackets <code>[]</code> for subsetting, and within them specify which elements to return. The elements to return can be a numeric vector (e.g. <code>c(1,2,4)</code>) to return the first, second, and fourth elements, or a logical vector indicating if an element should or should not be returned (e.g. <code>c(TRUE TRUE FALSE TRUE)</code>). If subsetting a range of consecutive elements, the <code>:</code> operator can also be used (e.g. <code>1:4</code> is the same as <code>c(1,2,3,4)</code>).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="2.2-binomial-distribution.html#cb23-1" tabindex="-1"></a><span class="co"># To avoid hard coding our estimated percent, we can use sum() on a subset of</span></span>
<span id="cb23-2"><a href="2.2-binomial-distribution.html#cb23-2" tabindex="-1"></a><span class="co"># the table of proportions to estimate the probability at least one survives?</span></span>
<span id="cb23-3"><a href="2.2-binomial-distribution.html#cb23-3" tabindex="-1"></a><span class="fu">sum</span>(survival_prob[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] 0.69</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="2.2-binomial-distribution.html#cb25-1" tabindex="-1"></a><span class="co"># what is the probability at least two survive?</span></span>
<span id="cb25-2"><a href="2.2-binomial-distribution.html#cb25-2" tabindex="-1"></a><span class="fu">sum</span>(survival_prob[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] 0.24</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="2.2-binomial-distribution.html#cb27-1" tabindex="-1"></a><span class="co"># side note: if you&#39;re not sure which indices to subset, it can help to look at</span></span>
<span id="cb27-2"><a href="2.2-binomial-distribution.html#cb27-2" tabindex="-1"></a><span class="co"># your object; you can easily do this in RStudio by highlighting just the bit of</span></span>
<span id="cb27-3"><a href="2.2-binomial-distribution.html#cb27-3" tabindex="-1"></a><span class="co"># code with your object name and using Ctrl + Enter (or Cmd + Enter) to print</span></span>
<span id="cb27-4"><a href="2.2-binomial-distribution.html#cb27-4" tabindex="-1"></a><span class="co"># just that object to the console, i.e. if you highlight part of a line, you will</span></span>
<span id="cb27-5"><a href="2.2-binomial-distribution.html#cb27-5" tabindex="-1"></a><span class="co"># only run the highlighted bit, not the entire line</span></span></code></pre></div>
</div>
<div id="coral-example" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Coral example</h3>
<p>With the guillemots, we were assuming that each pair had three potential offspring surviving. What happens if we vastly increase the number of draws from the binomial distribution? Take corals as an example. Some broadcast spawning corals have mass synchronized spawning events where individual corals on a reef all release bundles of sperm and eggs at the same time. The reproductive success of each individual coral can still be modeled as a binomial distribution, i.e. how many of those released sperm and eggs will actually encounter a bundle of the same species and be a successful mating attempt is a random variable drawn from a Binomial distribution with a number of draws <span class="math inline">\(N\)</span> equal to the number of released sperm and eggs and a probability of success <span class="math inline">\(p\)</span> for each of those. <span class="math display">\[ offspring \sim Binomial(N, p)\]</span>.</p>
<p>Note: the <span class="math inline">\(N\)</span> for denoting the number of draws from the Binomial is distinct from the <code>n =</code> argument in the <code>rbinom()</code> function. Don’t let this confuse you! <span class="math inline">\(N\)</span> equates to the <code>size =</code> argument, while <code>n =</code> is the number of observations of the random variable, i.e. the total number of individual corals on the reef.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/wsaZ8-I7akg?si=WFGkMdCDz_PCJgpq" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="2.2-binomial-distribution.html#cb28-1" tabindex="-1"></a><span class="co"># let&#39;s assume now the coral reef has 100,00 individual corals (I have no </span></span>
<span id="cb28-2"><a href="2.2-binomial-distribution.html#cb28-2" tabindex="-1"></a><span class="co"># clue if this is an accurate number, but let&#39;s roll with it)</span></span>
<span id="cb28-3"><a href="2.2-binomial-distribution.html#cb28-3" tabindex="-1"></a><span class="co"># let&#39;s also assume each individual coral releases 10,000 sperm and eggs</span></span>
<span id="cb28-4"><a href="2.2-binomial-distribution.html#cb28-4" tabindex="-1"></a><span class="co"># and the probability for each of those resulting in a successful mating event </span></span>
<span id="cb28-5"><a href="2.2-binomial-distribution.html#cb28-5" tabindex="-1"></a><span class="co"># 0.0002 (i.e. 0.002%)</span></span>
<span id="cb28-6"><a href="2.2-binomial-distribution.html#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="2.2-binomial-distribution.html#cb28-7" tabindex="-1"></a>gametes <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">size=</span><span class="dv">10000</span>, <span class="at">p=</span><span class="fl">0.0002</span>)</span>
<span id="cb28-8"><a href="2.2-binomial-distribution.html#cb28-8" tabindex="-1"></a><span class="fu">hist</span>(gametes, <span class="at">breaks =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672"  /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="2.2-binomial-distribution.html#cb29-1" tabindex="-1"></a><span class="co"># what is the probability of reproductive failure?</span></span>
<span id="cb29-2"><a href="2.2-binomial-distribution.html#cb29-2" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(gametes))</span></code></pre></div>
<pre><code>## gametes
##       0       1       2       3       4       5       6       7       8       9 
## 0.13312 0.27083 0.27112 0.18054 0.09084 0.03664 0.01231 0.00347 0.00089 0.00019 
##      10 
## 0.00005</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="2.2-binomial-distribution.html#cb31-1" tabindex="-1"></a><span class="co"># what&#39;s the probability of more than 5 offspring?</span></span>
<span id="cb31-2"><a href="2.2-binomial-distribution.html#cb31-2" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(gametes<span class="sc">&gt;</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## 
##   FALSE    TRUE 
## 0.98309 0.01691</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="2.2-binomial-distribution.html#cb33-1" tabindex="-1"></a><span class="co"># now let&#39;s increase the number of individual corals to 1 million, and also increase</span></span>
<span id="cb33-2"><a href="2.2-binomial-distribution.html#cb33-2" tabindex="-1"></a><span class="co"># the probability of success to 0.001 </span></span>
<span id="cb33-3"><a href="2.2-binomial-distribution.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="2.2-binomial-distribution.html#cb33-4" tabindex="-1"></a>gametes2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1000000</span>, <span class="at">size=</span><span class="dv">10000</span>, <span class="at">p=</span><span class="fl">0.001</span>)</span>
<span id="cb33-5"><a href="2.2-binomial-distribution.html#cb33-5" tabindex="-1"></a><span class="fu">hist</span>(gametes2, <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-2.png" width="672"  /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="2.2-binomial-distribution.html#cb34-1" tabindex="-1"></a><span class="co"># now what is the probability of reproductive failure?</span></span>
<span id="cb34-2"><a href="2.2-binomial-distribution.html#cb34-2" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(gametes2<span class="sc">==</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## 
##    FALSE     TRUE 
## 0.999965 0.000035</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="2.2-binomial-distribution.html#cb36-1" tabindex="-1"></a><span class="co"># and what is the probability of more than 15 offspring?</span></span>
<span id="cb36-2"><a href="2.2-binomial-distribution.html#cb36-2" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(gametes2<span class="sc">&gt;</span><span class="dv">15</span>))</span></code></pre></div>
<pre><code>## 
##    FALSE     TRUE 
## 0.951292 0.048708</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="2.2-binomial-distribution.html#cb38-1" tabindex="-1"></a><span class="co"># let&#39;s visualize the data as a histogram again, but add a vertical bar using </span></span>
<span id="cb38-2"><a href="2.2-binomial-distribution.html#cb38-2" tabindex="-1"></a><span class="co"># the abline() function at 15; note there are other plotting options to make </span></span>
<span id="cb38-3"><a href="2.2-binomial-distribution.html#cb38-3" tabindex="-1"></a><span class="co"># your plots slightly more aesthetic</span></span>
<span id="cb38-4"><a href="2.2-binomial-distribution.html#cb38-4" tabindex="-1"></a><span class="fu">hist</span>(gametes2, </span>
<span id="cb38-5"><a href="2.2-binomial-distribution.html#cb38-5" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">100</span>,</span>
<span id="cb38-6"><a href="2.2-binomial-distribution.html#cb38-6" tabindex="-1"></a>     <span class="at">border=</span>F, <span class="co"># i just don&#39;t like borders on bars</span></span>
<span id="cb38-7"><a href="2.2-binomial-distribution.html#cb38-7" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;turquoise4&quot;</span>, </span>
<span id="cb38-8"><a href="2.2-binomial-distribution.html#cb38-8" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="co"># removes the &#39;title&#39;</span></span>
<span id="cb38-9"><a href="2.2-binomial-distribution.html#cb38-9" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Number of successful mating attempts&quot;</span>, <span class="co"># changes x axis label</span></span>
<span id="cb38-10"><a href="2.2-binomial-distribution.html#cb38-10" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span> <span class="co"># rotates the axis labels the right way</span></span>
<span id="cb38-11"><a href="2.2-binomial-distribution.html#cb38-11" tabindex="-1"></a>     )</span>
<span id="cb38-12"><a href="2.2-binomial-distribution.html#cb38-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">15</span>, </span>
<span id="cb38-13"><a href="2.2-binomial-distribution.html#cb38-13" tabindex="-1"></a>       <span class="at">lwd=</span><span class="dv">2</span>, <span class="co"># width of line</span></span>
<span id="cb38-14"><a href="2.2-binomial-distribution.html#cb38-14" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;tomato2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-3.png" width="672"  /></p>
</div>
</div>
<p style="text-align: center;">
<a href="2.1-bernoulli-distribution.html"><button class="btn btn-default">Previous</button></a>
<a href="2.3-probability-mass.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
